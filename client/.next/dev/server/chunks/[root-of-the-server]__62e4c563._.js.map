{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sera%20Shine/Desktop/S62-1025-Nerdvana-Express-Full-Stack-With-NextjsAnd-AWS-Azure-Supply-Chain-Loco-Verify/client/src/app/api/admin/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport jwt from \"jsonwebtoken\";\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || \"supersecretkey\";\r\n\r\nexport async function GET(request: Request) {\r\n  try {\r\n    const authHeader = request.headers.get(\"authorization\");\r\n\r\n    if (!authHeader || !authHeader.startsWith(\"Bearer \")) {\r\n      return NextResponse.json(\r\n        { success: false, message: \"Authorization token missing\" },\r\n        { status: 401 }\r\n      );\r\n    }\r\n\r\n    const token = authHeader.split(\" \")[1];\r\n    const decoded = jwt.verify(token, JWT_SECRET) as { id: number; email: string; role: string };\r\n\r\n    // âœ… Restrict to Official users only\r\n    if (decoded.role !== \"Official\") {\r\n      return NextResponse.json(\r\n        { success: false, message: \"Access denied. Officials only.\" },\r\n        { status: 403 }\r\n      );\r\n    }\r\n\r\n    return NextResponse.json(\r\n      { success: true, message: \"Welcome Official! You have full access.\" },\r\n      { status: 200 }\r\n    );\r\n  } catch (error: any) {\r\n    console.error(\"Admin route error:\", error);\r\n    return NextResponse.json(\r\n      { success: false, message: \"Invalid or expired token\", details: error.message },\r\n      { status: 403 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;QAEvC,IAAI,CAAC,cAAc,CAAC,WAAW,UAAU,CAAC,YAAY;YACpD,OAAO,sSAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,SAAS;YAA8B,GACzD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,QAAQ,WAAW,KAAK,CAAC,IAAI,CAAC,EAAE;QACtC,MAAM,UAAU,wSAAG,CAAC,MAAM,CAAC,OAAO;QAElC,oCAAoC;QACpC,IAAI,QAAQ,IAAI,KAAK,YAAY;YAC/B,OAAO,sSAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,SAAS;YAAiC,GAC5D;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,sSAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAM,SAAS;QAA0C,GACpE;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,sSAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,SAAS;YAA4B,SAAS,MAAM,OAAO;QAAC,GAC9E;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}