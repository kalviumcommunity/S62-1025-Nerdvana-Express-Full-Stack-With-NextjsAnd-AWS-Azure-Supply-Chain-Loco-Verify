{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sera%20Shine/Desktop/S62-1025-Nerdvana-Express-Full-Stack-With-NextjsAnd-AWS-Azure-Supply-Chain-Loco-Verify/client/src/lib/logger.ts"],"sourcesContent":["interface LogMeta {\n  [key: string]: unknown;\n}\n\nexport const logger = {\n  info: (message: string, meta?: LogMeta) => {\n    console.log(JSON.stringify({ \n      level: \"info\", \n      message, \n      meta, \n      timestamp: new Date().toISOString() \n    }));\n  },\n  \n  error: (message: string, meta?: LogMeta) => {\n    console.error(JSON.stringify({ \n      level: \"error\", \n      message, \n      meta, \n      timestamp: new Date().toISOString() \n    }));\n  },\n  \n  warn: (message: string, meta?: LogMeta) => {\n    console.warn(JSON.stringify({ \n      level: \"warn\", \n      message, \n      meta, \n      timestamp: new Date().toISOString() \n    }));\n  },\n  \n  debug: (message: string, meta?: LogMeta) => {\n    console.debug(JSON.stringify({ \n      level: \"debug\", \n      message, \n      meta, \n      timestamp: new Date().toISOString() \n    }));\n  }\n};"],"names":[],"mappings":";;;;AAIO,MAAM,SAAS;IACpB,MAAM,CAAC,SAAiB;QACtB,QAAQ,GAAG,CAAC,KAAK,SAAS,CAAC;YACzB,OAAO;YACP;YACA;YACA,WAAW,IAAI,OAAO,WAAW;QACnC;IACF;IAEA,OAAO,CAAC,SAAiB;QACvB,QAAQ,KAAK,CAAC,KAAK,SAAS,CAAC;YAC3B,OAAO;YACP;YACA;YACA,WAAW,IAAI,OAAO,WAAW;QACnC;IACF;IAEA,MAAM,CAAC,SAAiB;QACtB,QAAQ,IAAI,CAAC,KAAK,SAAS,CAAC;YAC1B,OAAO;YACP;YACA;YACA,WAAW,IAAI,OAAO,WAAW;QACnC;IACF;IAEA,OAAO,CAAC,SAAiB;QACvB,QAAQ,KAAK,CAAC,KAAK,SAAS,CAAC;YAC3B,OAAO;YACP;YACA;YACA,WAAW,IAAI,OAAO,WAAW;QACnC;IACF;AACF","debugId":null}},
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sera%20Shine/Desktop/S62-1025-Nerdvana-Express-Full-Stack-With-NextjsAnd-AWS-Azure-Supply-Chain-Loco-Verify/client/src/lib/errorHandler.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { logger } from \"./logger\";\n\ninterface AppError extends Error {\n  name: string;\n  message: string;\n  stack?: string;\n  details?: unknown;\n}\n\nexport function handleError(error: unknown, context: string) {\n  const isProd = process.env.NODE_ENV === \"production\";\n\n  // Determine the appropriate status code\n  let statusCode = 500;\n  let errorMessage = \"Unknown error occurred\";\n\n  if (error instanceof Error) {\n    errorMessage = error.message;\n\n    // Handle different error types\n    if (error.name === 'ValidationError') {\n      statusCode = 400;\n    } else if (error.name === 'NotFoundError') {\n      statusCode = 404;\n    } else if (error.name === 'UnauthorizedError') {\n      statusCode = 401;\n    }\n  }\n\n  // Construct the error response\n  const errorResponse: {\n    success: boolean;\n    message: string;\n    stack?: string;\n    details?: unknown;\n  } = {\n    success: false,\n    message: isProd \n      ? getProductionMessage(statusCode)\n      : errorMessage,\n  };\n\n  // Include stack trace only in development\n  if (!isProd && error instanceof Error && error.stack) {\n    errorResponse.stack = error.stack;\n  }\n\n  // Include additional error details in development\n  if (!isProd && error instanceof Error && (error as AppError).details) {\n    errorResponse.details = (error as AppError).details;\n  }\n\n  // Log the error with structured data\n  logger.error(`Error in ${context}`, {\n    message: errorMessage,\n    statusCode: statusCode,\n    stack: isProd ? \"REDACTED\" : (error instanceof Error ? error.stack : \"No stack\"),\n    context: context,\n    timestamp: new Date().toISOString()\n  });\n\n  return NextResponse.json(errorResponse, { status: statusCode });\n}\n\n// Helper function to get user-friendly production messages\nfunction getProductionMessage(statusCode: number): string {\n  const messages: { [key: number]: string } = {\n    400: \"Invalid request. Please check your input.\",\n    401: \"Authentication required. Please log in.\",\n    403: \"You don't have permission to access this resource.\",\n    404: \"The requested resource was not found.\",\n    500: \"Something went wrong. Please try again later.\",\n    503: \"Service temporarily unavailable. Please try again later.\"\n  };\n\n  return messages[statusCode] || \"Something went wrong. Please try again later.\";\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;AASO,SAAS,YAAY,KAAc,EAAE,OAAe;IACzD,MAAM,SAAS,oDAAyB;IAExC,wCAAwC;IACxC,IAAI,aAAa;IACjB,IAAI,eAAe;IAEnB,IAAI,iBAAiB,OAAO;QAC1B,eAAe,MAAM,OAAO;QAE5B,+BAA+B;QAC/B,IAAI,MAAM,IAAI,KAAK,mBAAmB;YACpC,aAAa;QACf,OAAO,IAAI,MAAM,IAAI,KAAK,iBAAiB;YACzC,aAAa;QACf,OAAO,IAAI,MAAM,IAAI,KAAK,qBAAqB;YAC7C,aAAa;QACf;IACF;IAEA,+BAA+B;IAC/B,MAAM,gBAKF;QACF,SAAS;QACT,SAAS,sCACL,0BACA;IACN;IAEA,0CAA0C;IAC1C,IAAI,CAAC,UAAU,iBAAiB,SAAS,MAAM,KAAK,EAAE;QACpD,cAAc,KAAK,GAAG,MAAM,KAAK;IACnC;IAEA,kDAAkD;IAClD,IAAI,CAAC,UAAU,iBAAiB,SAAS,AAAC,MAAmB,OAAO,EAAE;QACpE,cAAc,OAAO,GAAG,AAAC,MAAmB,OAAO;IACrD;IAEA,qCAAqC;IACrC,sRAAM,CAAC,KAAK,CAAC,CAAC,SAAS,EAAE,SAAS,EAAE;QAClC,SAAS;QACT,YAAY;QACZ,OAAO,sCAAS,0BAAc,iBAAiB,QAAQ,MAAM,KAAK,GAAG;QACrE,SAAS;QACT,WAAW,IAAI,OAAO,WAAW;IACnC;IAEA,OAAO,sSAAY,CAAC,IAAI,CAAC,eAAe;QAAE,QAAQ;IAAW;AAC/D;AAEA,2DAA2D;AAC3D,SAAS,qBAAqB,UAAkB;IAC9C,MAAM,WAAsC;QAC1C,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;IACP;IAEA,OAAO,QAAQ,CAAC,WAAW,IAAI;AACjC","debugId":null}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Sera%20Shine/Desktop/S62-1025-Nerdvana-Express-Full-Stack-With-NextjsAnd-AWS-Azure-Supply-Chain-Loco-Verify/client/src/app/api/admin/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport jwt from \"jsonwebtoken\";\nimport { handleError } from \"../../../lib/errorHandler\"; // ADD THIS IMPORT\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"supersecretkey\";\n\nexport async function GET(request: Request) {\n  try {\n    const authHeader = request.headers.get(\"authorization\");\n\n    if (!authHeader || !authHeader.startsWith(\"Bearer \")) {\n      const error = new Error(\"Authorization token missing\");\n      error.name = \"UnauthorizedError\";\n      throw error;\n    }\n\n    const token = authHeader.split(\" \")[1];\n\n    let decoded;\n    try {\n      decoded = jwt.verify(token, JWT_SECRET) as {\n        id: number;\n        email: string;\n        role: string;\n      };\n    } catch  {\n      const error = new Error(\"Invalid or expired token\");\n      error.name = \"UnauthorizedError\";\n      throw error;\n    }\n\n    // âœ… Restrict to Official users only\n    if (decoded.role !== \"Official\") {\n      const error = new Error(\"Access denied. Officials only.\");\n      error.name = \"UnauthorizedError\";\n      throw error;\n    }\n\n    return NextResponse.json(\n      { success: true, message: \"Welcome Official! You have full access.\" },\n      { status: 200 }\n    );\n  } catch (error) {\n    return handleError(error, \"GET /api/admin\"); // REPLACE ERROR HANDLING\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA,sdAAyD,kBAAkB;;;;AAE3E,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;QAEvC,IAAI,CAAC,cAAc,CAAC,WAAW,UAAU,CAAC,YAAY;YACpD,MAAM,QAAQ,IAAI,MAAM;YACxB,MAAM,IAAI,GAAG;YACb,MAAM;QACR;QAEA,MAAM,QAAQ,WAAW,KAAK,CAAC,IAAI,CAAC,EAAE;QAEtC,IAAI;QACJ,IAAI;YACF,UAAU,wSAAG,CAAC,MAAM,CAAC,OAAO;QAK9B,EAAE,OAAO;YACP,MAAM,QAAQ,IAAI,MAAM;YACxB,MAAM,IAAI,GAAG;YACb,MAAM;QACR;QAEA,oCAAoC;QACpC,IAAI,QAAQ,IAAI,KAAK,YAAY;YAC/B,MAAM,QAAQ,IAAI,MAAM;YACxB,MAAM,IAAI,GAAG;YACb,MAAM;QACR;QAEA,OAAO,sSAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAM,SAAS;QAA0C,GACpE;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,OAAO,IAAA,iSAAW,EAAC,OAAO,mBAAmB,yBAAyB;IACxE;AACF","debugId":null}}]
}